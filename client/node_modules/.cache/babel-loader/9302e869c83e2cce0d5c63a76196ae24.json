{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Joseph\\\\Desktop\\\\BcThesis\\\\licenta_aplicatie\\\\code-puls\\\\client\\\\src\\\\pages\\\\takeTest.js\",\n    _s = $RefreshSig$();\n\nimport { Card, Button } from \"../components/defaultComponents\";\nimport { CodeEditor, Loader, QuestionSlider } from \"../components\";\nimport styled from \"styled-components\";\nimport React, { useEffect, useState, useContext } from \"react\";\nimport { AuthContext } from \"../context/AuthContext\";\nimport { AppContext } from \"../context/context\";\nimport DefaultCode from \"../components/defaultCodeData\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst rootURL = \"http://localhost:5000/api\";\n\nfunction TakeTest({\n  test\n}) {\n  _s();\n\n  const {\n    setShowNavbar,\n    setShowHeader\n  } = useContext(AppContext);\n  setShowNavbar(false);\n  setShowHeader(true); //get current User\n\n  const auth = useContext(AuthContext);\n  const {\n    authState\n  } = auth;\n  const user = authState.userInfo;\n  const {\n    testQuestions,\n    getTestQuestions,\n    isLoading,\n    aceLanguages,\n    encode,\n    decode\n  } = React.useContext(AppContext);\n  const [language, setLanguage] = useState(\"javascript\");\n  const [stdout, setStdout] = useState(\" \");\n  const [compileError, setCompileError] = useState();\n  const [testCaseStatus, setTestCaseStatus] = useState(\" \");\n  const [judgeResponse, setJudgeResponse] = useState();\n  const [isConsoleLoading, setIsConsoleLoading] = useState(false);\n  const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);\n  const [currentQuestion, setCurrentQuestion] = useState({\n    id: 0\n  });\n  const [codeEditorText, setCodeEditorText] = useState([]);\n  const [currentCodeEditorText, setCurrentCodeEditorText] = useState(); //onMount\n\n  useEffect(() => {\n    // console.log(\"onMount\");\n    // console.log(test.id);\n    getTestQuestions(test.id); // console.log(testQuestions);\n\n    const aceLanguage = aceLanguages.find(language => language.id == test.id_limbaj_programare);\n\n    if (aceLanguage) {\n      setLanguage(aceLanguage.name);\n    }\n  }, []); //Initialize codeEditor with default code\n\n  useEffect(() => {\n    if (testQuestions) {\n      const defaultCode = DefaultCode.find(item => item.id == test.id_limbaj_programare);\n\n      if (defaultCode) {\n        let array = [];\n        testQuestions.map(element => {\n          array.push(defaultCode.code);\n        });\n        setCodeEditorText(array);\n      }\n    }\n  }, [testQuestions]); //When judgeResponse change\n\n  useEffect(() => {\n    console.log(\"judge response changed\");\n\n    if (judgeResponse) {\n      setStdout(decode(judgeResponse.stdout));\n      setTestCaseStatus(judgeResponse.status.description);\n      setCompileError(decode(judgeResponse.compile_output));\n    }\n  }, [judgeResponse]);\n\n  function questionChanged(question, index) {\n    console.log(testQuestions);\n    console.log(question);\n    setCurrentQuestionIndex(index);\n    setCurrentQuestion(question);\n  }\n\n  function codeEditorTextChanged(text) {\n    console.log(text);\n    let temp_state = [...codeEditorText];\n\n    if (codeEditorText.length > currentQuestionIndex) {\n      temp_state[currentQuestionIndex] = text;\n    } else {\n      temp_state.push(text);\n    }\n\n    setCodeEditorText(temp_state);\n    setCurrentCodeEditorText(text);\n  }\n\n  const getJudgeAssessment = async test => {\n    console.log(\"getting assessment from judge...\");\n    setIsConsoleLoading(true);\n    const judgeData = {\n      source_code: test.source_cod,\n      language_id: test.language_id,\n      stdin: test.stdin\n    }; // console.log(test.source_cod);\n\n    const response = await axios({\n      method: \"post\",\n      url: `${rootURL}/questions/assess/${test.questionId}/${test.id}/${user.id}`,\n      data: judgeData\n    }).catch(err => console.log(err));\n\n    if (response) {\n      console.log(response.data);\n      setJudgeResponse(response.data);\n    }\n\n    setIsConsoleLoading(false);\n  };\n\n  function executaBtnHandler() {\n    if (!isConsoleLoading) {\n      console.log(\"buton executa apasat\");\n      const assignment = {\n        id: test.id,\n        questionId: currentQuestion.id,\n        source_cod: encode(codeEditorText[currentQuestionIndex]),\n        language_id: test.id_limbaj_programare,\n        stdin: \"\"\n      };\n      console.log(assignment);\n      getJudgeAssessment(assignment);\n    }\n  } // useEffect(() => {\n  //   console.log(codeEditorText);\n  // }, [codeEditorText]);\n\n\n  if (isLoading) {\n    return /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 12\n    }, this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(Wrapper, {\n      children: [/*#__PURE__*/_jsxDEV(ProblemCard, {\n        children: /*#__PURE__*/_jsxDEV(QuestionSlider, {\n          questions: testQuestions,\n          callback: questionChanged\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(EditorCard, {\n        children: /*#__PURE__*/_jsxDEV(CodeEditor, {\n          language: language,\n          value: codeEditorText[currentQuestionIndex],\n          defaultCode: currentCodeEditorText,\n          callback: codeEditorTextChanged\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ExecuteBtn, {\n        primary: true,\n        onClick: executaBtnHandler,\n        children: \"Executa\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ConsoleCard, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [\" \", /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Output:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 171,\n            columnNumber: 13\n          }, this), !isConsoleLoading && stdout && /*#__PURE__*/_jsxDEV(\"p\", {\n            children: stdout\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 172,\n            columnNumber: 45\n          }, this), isConsoleLoading && /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Loading...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 173,\n            columnNumber: 34\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Test Case Status:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 176,\n            columnNumber: 13\n          }, this), !isConsoleLoading && testCaseStatus && /*#__PURE__*/_jsxDEV(\"p\", {\n            children: testCaseStatus\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 177,\n            columnNumber: 53\n          }, this), isConsoleLoading && /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Loading...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 178,\n            columnNumber: 34\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 11\n        }, this), !isConsoleLoading && compileError && /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Compile Error:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 183,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 182,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: compileError\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 185,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(SubmitBtn, {\n        secondary: true,\n        children: \"Trimite\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 145,\n    columnNumber: 5\n  }, this);\n}\n\n_s(TakeTest, \"qlK3O4SH4XgIP5uM6B94gsWNzhQ=\");\n\n_c = TakeTest;\nconst Wrapper = styled.section`\n  display: grid;\n  height: 100%;\n  width: 100%;\n  max-height: 700px;\n  grid-template-columns: repeat(2, 1fr);\n  grid-template-rows: repeat(10, 1fr);\n  grid-template-areas:\n    \"A    B\"\n    \"A    B\"\n    \"A    B\"\n    \"A    B\"\n    \"A    B\"\n    \"A    B\"\n    \"A    D\"\n    \"A    C\"\n    \"A    C\"\n    \"A    E\";\n  grid-column-gap: 2em;\n`;\n_c2 = Wrapper;\nconst ProblemCard = styled(Card)`\n  grid-area: A;\n  overflow: auto;\n  margin-left: 2em;\n`;\n_c3 = ProblemCard;\nconst EditorCard = styled(Card)`\n  grid-area: B;\n  margin-right: 2em;\n  margin-top: 3em;\n  align-items: streched\n  justify-items : streched;\n  \n`;\n_c4 = EditorCard;\nconst ConsoleCard = styled(Card)`\n  grid-area: C;\n  margin-right: 2em;\n  position: relative;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  overflow: auto;\n  flex-wrap: wrap;\n`;\n_c5 = ConsoleCard;\nconst ExecuteBtn = styled(Button)`\n  height: 50px;\n  width: 150px;\n  grid-are: D;\n  justify-self: start;\n  align-self: center;\n`;\n_c6 = ExecuteBtn;\nconst SubmitBtn = styled(Button)`\n  height: 50px;\n  width: 150px;\n  grid-are: E;\n  justify-self: end;\n  align-self: center;\n  margin-right: 2em;\n`;\n_c7 = SubmitBtn;\nexport default TakeTest;\n\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7;\n\n$RefreshReg$(_c, \"TakeTest\");\n$RefreshReg$(_c2, \"Wrapper\");\n$RefreshReg$(_c3, \"ProblemCard\");\n$RefreshReg$(_c4, \"EditorCard\");\n$RefreshReg$(_c5, \"ConsoleCard\");\n$RefreshReg$(_c6, \"ExecuteBtn\");\n$RefreshReg$(_c7, \"SubmitBtn\");","map":{"version":3,"sources":["C:/Users/Joseph/Desktop/BcThesis/licenta_aplicatie/code-puls/client/src/pages/takeTest.js"],"names":["Card","Button","CodeEditor","Loader","QuestionSlider","styled","React","useEffect","useState","useContext","AuthContext","AppContext","DefaultCode","axios","rootURL","TakeTest","test","setShowNavbar","setShowHeader","auth","authState","user","userInfo","testQuestions","getTestQuestions","isLoading","aceLanguages","encode","decode","language","setLanguage","stdout","setStdout","compileError","setCompileError","testCaseStatus","setTestCaseStatus","judgeResponse","setJudgeResponse","isConsoleLoading","setIsConsoleLoading","currentQuestionIndex","setCurrentQuestionIndex","currentQuestion","setCurrentQuestion","id","codeEditorText","setCodeEditorText","currentCodeEditorText","setCurrentCodeEditorText","aceLanguage","find","id_limbaj_programare","name","defaultCode","item","array","map","element","push","code","console","log","status","description","compile_output","questionChanged","question","index","codeEditorTextChanged","text","temp_state","length","getJudgeAssessment","judgeData","source_code","source_cod","language_id","stdin","response","method","url","questionId","data","catch","err","executaBtnHandler","assignment","Wrapper","section","ProblemCard","EditorCard","ConsoleCard","ExecuteBtn","SubmitBtn"],"mappings":"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","sourcesContent":["import { Card, Button } from \"../components/defaultComponents\";\r\nimport { CodeEditor, Loader, QuestionSlider } from \"../components\";\r\nimport styled from \"styled-components\";\r\nimport React, { useEffect, useState, useContext } from \"react\";\r\nimport { AuthContext } from \"../context/AuthContext\";\r\nimport { AppContext } from \"../context/context\";\r\nimport DefaultCode from \"../components/defaultCodeData\";\r\nimport axios from \"axios\";\r\nconst rootURL = \"http://localhost:5000/api\";\r\n\r\nfunction TakeTest({ test }) {\r\n  const { setShowNavbar, setShowHeader } = useContext(AppContext);\r\n  setShowNavbar(false);\r\n  setShowHeader(true);\r\n\r\n  //get current User\r\n  const auth = useContext(AuthContext);\r\n  const { authState } = auth;\r\n  const user = authState.userInfo;\r\n\r\n  const {\r\n    testQuestions,\r\n    getTestQuestions,\r\n    isLoading,\r\n    aceLanguages,\r\n    encode,\r\n    decode,\r\n  } = React.useContext(AppContext);\r\n\r\n  const [language, setLanguage] = useState(\"javascript\");\r\n  const [stdout, setStdout] = useState(\" \");\r\n  const [compileError, setCompileError] = useState();\r\n  const [testCaseStatus, setTestCaseStatus] = useState(\" \");\r\n  const [judgeResponse, setJudgeResponse] = useState();\r\n  const [isConsoleLoading, setIsConsoleLoading] = useState(false);\r\n  const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);\r\n  const [currentQuestion, setCurrentQuestion] = useState({ id: 0 });\r\n  const [codeEditorText, setCodeEditorText] = useState([]);\r\n  const [currentCodeEditorText, setCurrentCodeEditorText] = useState();\r\n  //onMount\r\n  useEffect(() => {\r\n    // console.log(\"onMount\");\r\n    // console.log(test.id);\r\n    getTestQuestions(test.id);\r\n    // console.log(testQuestions);\r\n    const aceLanguage = aceLanguages.find(\r\n      (language) => language.id == test.id_limbaj_programare\r\n    );\r\n    if (aceLanguage) {\r\n      setLanguage(aceLanguage.name);\r\n    }\r\n  }, []);\r\n\r\n  //Initialize codeEditor with default code\r\n  useEffect(() => {\r\n    if (testQuestions) {\r\n      const defaultCode = DefaultCode.find(\r\n        (item) => item.id == test.id_limbaj_programare\r\n      );\r\n      if (defaultCode) {\r\n        let array = [];\r\n        testQuestions.map((element) => {\r\n          array.push(defaultCode.code);\r\n        });\r\n        setCodeEditorText(array);\r\n      }\r\n    }\r\n  }, [testQuestions]);\r\n\r\n  //When judgeResponse change\r\n  useEffect(() => {\r\n    console.log(\"judge response changed\");\r\n    if (judgeResponse) {\r\n      setStdout(decode(judgeResponse.stdout));\r\n      setTestCaseStatus(judgeResponse.status.description);\r\n      setCompileError(decode(judgeResponse.compile_output));\r\n    }\r\n  }, [judgeResponse]);\r\n\r\n  function questionChanged(question, index) {\r\n    console.log(testQuestions);\r\n    console.log(question);\r\n    setCurrentQuestionIndex(index);\r\n    setCurrentQuestion(question);\r\n  }\r\n  function codeEditorTextChanged(text) {\r\n    console.log(text);\r\n\r\n    let temp_state = [...codeEditorText];\r\n\r\n    if (codeEditorText.length > currentQuestionIndex) {\r\n      temp_state[currentQuestionIndex] = text;\r\n    } else {\r\n      temp_state.push(text);\r\n    }\r\n    setCodeEditorText(temp_state);\r\n    setCurrentCodeEditorText(text);\r\n  }\r\n\r\n  const getJudgeAssessment = async (test) => {\r\n    console.log(\"getting assessment from judge...\");\r\n    setIsConsoleLoading(true);\r\n    const judgeData = {\r\n      source_code: test.source_cod,\r\n      language_id: test.language_id,\r\n      stdin: test.stdin,\r\n    };\r\n    // console.log(test.source_cod);\r\n    const response = await axios({\r\n      method: \"post\",\r\n      url: `${rootURL}/questions/assess/${test.questionId}/${test.id}/${user.id}`,\r\n      data: judgeData,\r\n    }).catch((err) => console.log(err));\r\n\r\n    if (response) {\r\n      console.log(response.data);\r\n      setJudgeResponse(response.data);\r\n    }\r\n    setIsConsoleLoading(false);\r\n  };\r\n  function executaBtnHandler() {\r\n    if (!isConsoleLoading) {\r\n      console.log(\"buton executa apasat\");\r\n      const assignment = {\r\n        id: test.id,\r\n        questionId: currentQuestion.id,\r\n        source_cod: encode(codeEditorText[currentQuestionIndex]),\r\n        language_id: test.id_limbaj_programare,\r\n        stdin: \"\",\r\n      };\r\n      console.log(assignment);\r\n      getJudgeAssessment(assignment);\r\n    }\r\n  }\r\n\r\n  // useEffect(() => {\r\n  //   console.log(codeEditorText);\r\n  // }, [codeEditorText]);\r\n\r\n  if (isLoading) {\r\n    return <Loader></Loader>;\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <Wrapper>\r\n        <ProblemCard>\r\n          <QuestionSlider\r\n            questions={testQuestions}\r\n            callback={questionChanged}\r\n          ></QuestionSlider>\r\n          {/* {testQuestions.map((question) => (\r\n            <h3>{question.descriere}</h3>\r\n          ))}\r\n          <h3>{testQuestions[0].descriere}</h3> */}\r\n        </ProblemCard>\r\n        <EditorCard>\r\n          <CodeEditor\r\n            language={language}\r\n            value={codeEditorText[currentQuestionIndex]}\r\n            defaultCode={currentCodeEditorText}\r\n            callback={codeEditorTextChanged}\r\n          ></CodeEditor>\r\n        </EditorCard>\r\n        <ExecuteBtn primary onClick={executaBtnHandler}>\r\n          Executa\r\n        </ExecuteBtn>\r\n        <ConsoleCard>\r\n          <div>\r\n            {\" \"}\r\n            <p>Output:</p>\r\n            {!isConsoleLoading && stdout && <p>{stdout}</p>}\r\n            {isConsoleLoading && <p>Loading...</p>}\r\n          </div>\r\n          <div>\r\n            <p>Test Case Status:</p>\r\n            {!isConsoleLoading && testCaseStatus && <p>{testCaseStatus}</p>}\r\n            {isConsoleLoading && <p>Loading...</p>}\r\n          </div>\r\n          {!isConsoleLoading && compileError && (\r\n            <div>\r\n              <div>\r\n                <p>Compile Error:</p>\r\n              </div>\r\n              <p>{compileError}</p>\r\n            </div>\r\n          )}\r\n        </ConsoleCard>\r\n        <SubmitBtn secondary>Trimite</SubmitBtn>\r\n      </Wrapper>\r\n    </div>\r\n  );\r\n}\r\n\r\nconst Wrapper = styled.section`\r\n  display: grid;\r\n  height: 100%;\r\n  width: 100%;\r\n  max-height: 700px;\r\n  grid-template-columns: repeat(2, 1fr);\r\n  grid-template-rows: repeat(10, 1fr);\r\n  grid-template-areas:\r\n    \"A    B\"\r\n    \"A    B\"\r\n    \"A    B\"\r\n    \"A    B\"\r\n    \"A    B\"\r\n    \"A    B\"\r\n    \"A    D\"\r\n    \"A    C\"\r\n    \"A    C\"\r\n    \"A    E\";\r\n  grid-column-gap: 2em;\r\n`;\r\nconst ProblemCard = styled(Card)`\r\n  grid-area: A;\r\n  overflow: auto;\r\n  margin-left: 2em;\r\n`;\r\nconst EditorCard = styled(Card)`\r\n  grid-area: B;\r\n  margin-right: 2em;\r\n  margin-top: 3em;\r\n  align-items: streched\r\n  justify-items : streched;\r\n  \r\n`;\r\nconst ConsoleCard = styled(Card)`\r\n  grid-area: C;\r\n  margin-right: 2em;\r\n  position: relative;\r\n  display: flex;\r\n  flex-direction: row;\r\n  justify-content: space-between;\r\n  overflow: auto;\r\n  flex-wrap: wrap;\r\n`;\r\nconst ExecuteBtn = styled(Button)`\r\n  height: 50px;\r\n  width: 150px;\r\n  grid-are: D;\r\n  justify-self: start;\r\n  align-self: center;\r\n`;\r\nconst SubmitBtn = styled(Button)`\r\n  height: 50px;\r\n  width: 150px;\r\n  grid-are: E;\r\n  justify-self: end;\r\n  align-self: center;\r\n  margin-right: 2em;\r\n`;\r\n\r\nexport default TakeTest;\r\n"]},"metadata":{},"sourceType":"module"}