{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Joseph\\\\Desktop\\\\BcThesis\\\\licenta_aplicatie\\\\code-puls\\\\client\\\\src\\\\context\\\\AuthContext.js\",\n    _s = $RefreshSig$();\n\nimport React, { createContext, useState } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext();\nconst {\n  Provider\n} = AuthContext;\n\nconst AuthProvider = ({\n  children\n}) => {\n  _s();\n\n  const history = useHistory();\n  const token = localStorage.getItem(\"token\");\n  const userInfo = localStorage.getItem(\"userInfo\");\n  const expiresAt = localStorage.getItem(\"expiresAt\");\n  const [authState, setAuthState] = useState({\n    token,\n    expiresAt,\n    userInfo: userInfo ? JSON.parse(userInfo) : {}\n  });\n\n  const setAuthInfo = ({\n    token,\n    userInfo,\n    expiresAt\n  }) => {\n    localStorage.setItem(\"token\", token);\n    localStorage.setItem(\"userInfo\", JSON.stringify(userInfo));\n    localStorage.setItem(\"expiresAt\", expiresAt);\n    setAuthState({\n      token,\n      userInfo,\n      expiresAt\n    });\n  };\n\n  const logout = () => {\n    localStorage.removeItem(\"token\");\n    localStorage.removeItem(\"userInfo\");\n    localStorage.removeItem(\"expiresAt\");\n    history.push(\"/login\");\n    setTimeout(() => {\n      setAuthState({\n        token: null,\n        expiresAt: null,\n        userInfo: {}\n      });\n    }, 400);\n  };\n\n  const isAuthenticated = () => {\n    if (!authState.token || !authState.expiresAt) {\n      return false;\n    }\n\n    return new Date().getTime() / 1000 < authState.expiresAt;\n  };\n\n  return /*#__PURE__*/_jsxDEV(Provider, {\n    value: {\n      authState,\n      setAuthState: authInfo => setAuthInfo(authInfo),\n      logout,\n      isAuthenticated\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 54,\n    columnNumber: 5\n  }, this);\n};\n\n_s(AuthProvider, \"kq2TqGre9zoCpqYPuJGQ1m2i6JQ=\", false, function () {\n  return [useHistory];\n});\n\n_c = AuthProvider;\nexport { AuthContext, AuthProvider };\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"sources":["C:/Users/Joseph/Desktop/BcThesis/licenta_aplicatie/code-puls/client/src/context/AuthContext.js"],"names":["React","createContext","useState","useHistory","AuthContext","Provider","AuthProvider","children","history","token","localStorage","getItem","userInfo","expiresAt","authState","setAuthState","JSON","parse","setAuthInfo","setItem","stringify","logout","removeItem","push","setTimeout","isAuthenticated","Date","getTime","authInfo"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,aAAhB,EAA+BC,QAA/B,QAA+C,OAA/C;AACA,SAASC,UAAT,QAA2B,kBAA3B;;AAEA,MAAMC,WAAW,gBAAGH,aAAa,EAAjC;AACA,MAAM;AAAEI,EAAAA;AAAF,IAAeD,WAArB;;AAEA,MAAME,YAAY,GAAG,CAAC;AAAEC,EAAAA;AAAF,CAAD,KAAkB;AAAA;;AACrC,QAAMC,OAAO,GAAGL,UAAU,EAA1B;AAEA,QAAMM,KAAK,GAAGC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAd;AACA,QAAMC,QAAQ,GAAGF,YAAY,CAACC,OAAb,CAAqB,UAArB,CAAjB;AACA,QAAME,SAAS,GAAGH,YAAY,CAACC,OAAb,CAAqB,WAArB,CAAlB;AAEA,QAAM,CAACG,SAAD,EAAYC,YAAZ,IAA4Bb,QAAQ,CAAC;AACzCO,IAAAA,KADyC;AAEzCI,IAAAA,SAFyC;AAGzCD,IAAAA,QAAQ,EAAEA,QAAQ,GAAGI,IAAI,CAACC,KAAL,CAAWL,QAAX,CAAH,GAA0B;AAHH,GAAD,CAA1C;;AAMA,QAAMM,WAAW,GAAG,CAAC;AAAET,IAAAA,KAAF;AAASG,IAAAA,QAAT;AAAmBC,IAAAA;AAAnB,GAAD,KAAoC;AACtDH,IAAAA,YAAY,CAACS,OAAb,CAAqB,OAArB,EAA8BV,KAA9B;AACAC,IAAAA,YAAY,CAACS,OAAb,CAAqB,UAArB,EAAiCH,IAAI,CAACI,SAAL,CAAeR,QAAf,CAAjC;AACAF,IAAAA,YAAY,CAACS,OAAb,CAAqB,WAArB,EAAkCN,SAAlC;AAEAE,IAAAA,YAAY,CAAC;AACXN,MAAAA,KADW;AAEXG,MAAAA,QAFW;AAGXC,MAAAA;AAHW,KAAD,CAAZ;AAKD,GAVD;;AAYA,QAAMQ,MAAM,GAAG,MAAM;AACnBX,IAAAA,YAAY,CAACY,UAAb,CAAwB,OAAxB;AACAZ,IAAAA,YAAY,CAACY,UAAb,CAAwB,UAAxB;AACAZ,IAAAA,YAAY,CAACY,UAAb,CAAwB,WAAxB;AACAd,IAAAA,OAAO,CAACe,IAAR,CAAa,QAAb;AACAC,IAAAA,UAAU,CAAC,MAAM;AACfT,MAAAA,YAAY,CAAC;AACXN,QAAAA,KAAK,EAAE,IADI;AAEXI,QAAAA,SAAS,EAAE,IAFA;AAGXD,QAAAA,QAAQ,EAAE;AAHC,OAAD,CAAZ;AAKD,KANS,EAMP,GANO,CAAV;AAOD,GAZD;;AAcA,QAAMa,eAAe,GAAG,MAAM;AAC5B,QAAI,CAACX,SAAS,CAACL,KAAX,IAAoB,CAACK,SAAS,CAACD,SAAnC,EAA8C;AAC5C,aAAO,KAAP;AACD;;AACD,WAAO,IAAIa,IAAJ,GAAWC,OAAX,KAAuB,IAAvB,GAA8Bb,SAAS,CAACD,SAA/C;AACD,GALD;;AAOA,sBACE,QAAC,QAAD;AACE,IAAA,KAAK,EAAE;AACLC,MAAAA,SADK;AAELC,MAAAA,YAAY,EAAGa,QAAD,IAAcV,WAAW,CAACU,QAAD,CAFlC;AAGLP,MAAAA,MAHK;AAILI,MAAAA;AAJK,KADT;AAAA,cAQGlB;AARH;AAAA;AAAA;AAAA;AAAA,UADF;AAYD,CA1DD;;GAAMD,Y;UACYH,U;;;KADZG,Y;AA4DN,SAASF,WAAT,EAAsBE,YAAtB","sourcesContent":["import React, { createContext, useState } from \"react\";\r\nimport { useHistory } from \"react-router-dom\";\r\n\r\nconst AuthContext = createContext();\r\nconst { Provider } = AuthContext;\r\n\r\nconst AuthProvider = ({ children }) => {\r\n  const history = useHistory();\r\n\r\n  const token = localStorage.getItem(\"token\");\r\n  const userInfo = localStorage.getItem(\"userInfo\");\r\n  const expiresAt = localStorage.getItem(\"expiresAt\");\r\n\r\n  const [authState, setAuthState] = useState({\r\n    token,\r\n    expiresAt,\r\n    userInfo: userInfo ? JSON.parse(userInfo) : {},\r\n  });\r\n\r\n  const setAuthInfo = ({ token, userInfo, expiresAt }) => {\r\n    localStorage.setItem(\"token\", token);\r\n    localStorage.setItem(\"userInfo\", JSON.stringify(userInfo));\r\n    localStorage.setItem(\"expiresAt\", expiresAt);\r\n\r\n    setAuthState({\r\n      token,\r\n      userInfo,\r\n      expiresAt,\r\n    });\r\n  };\r\n\r\n  const logout = () => {\r\n    localStorage.removeItem(\"token\");\r\n    localStorage.removeItem(\"userInfo\");\r\n    localStorage.removeItem(\"expiresAt\");\r\n    history.push(\"/login\");\r\n    setTimeout(() => {\r\n      setAuthState({\r\n        token: null,\r\n        expiresAt: null,\r\n        userInfo: {},\r\n      });\r\n    }, 400);\r\n  };\r\n\r\n  const isAuthenticated = () => {\r\n    if (!authState.token || !authState.expiresAt) {\r\n      return false;\r\n    }\r\n    return new Date().getTime() / 1000 < authState.expiresAt;\r\n  };\r\n\r\n  return (\r\n    <Provider\r\n      value={{\r\n        authState,\r\n        setAuthState: (authInfo) => setAuthInfo(authInfo),\r\n        logout,\r\n        isAuthenticated,\r\n      }}\r\n    >\r\n      {children}\r\n    </Provider>\r\n  );\r\n};\r\n\r\nexport { AuthContext, AuthProvider };\r\n"]},"metadata":{},"sourceType":"module"}