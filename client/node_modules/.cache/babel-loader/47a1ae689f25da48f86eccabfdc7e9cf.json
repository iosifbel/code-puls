{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Joseph\\\\Desktop\\\\BcThesis\\\\licenta_aplicatie\\\\code-puls\\\\client\\\\src\\\\pages\\\\takeTest.js\",\n    _s = $RefreshSig$();\n\nimport { Card, Button } from \"../components/defaultComponents\";\nimport { CodeEditor, Loader, QuestionSlider } from \"../components\";\nimport styled from \"styled-components\";\nimport React, { useEffect, useState, useContext } from \"react\";\nimport { AuthContext } from \"../context/AuthContext\";\nimport { AppContext } from \"../context/context\";\nimport DefaultCode from \"../components/defaultCodeData\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst rootURL = \"http://localhost:5000/api\";\n\nfunction TakeTest({\n  test\n}) {\n  _s();\n\n  const {\n    setShowNavbar,\n    setShowHeader\n  } = useContext(AppContext);\n  setShowNavbar(false);\n  setShowHeader(true); //get current User\n\n  const auth = useContext(AuthContext);\n  const {\n    authState\n  } = auth;\n  const user = authState.userInfo;\n  const {\n    testQuestions,\n    getTestQuestions,\n    isLoading,\n    aceLanguages,\n    encode,\n    decode\n  } = React.useContext(AppContext);\n  const [language, setLanguage] = useState(\"javascript\");\n  const [stdout, setStdout] = useState(\" \");\n  const [compileError, setCompileError] = useState();\n  const [testCaseStatus, setTestCaseStatus] = useState(\" \");\n  const [judgeResponse, setJudgeResponse] = useState();\n  const [isConsoleLoading, setIsConsoleLoading] = useState(false);\n  const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);\n  const [currentQuestion, setCurrentQuestion] = useState(testQuestions[0]);\n  const [codeEditorText, setCodeEditorText] = useState([]);\n  const [currentCodeEditorText, setCurrentCodeEditorText] = useState(); //onMount\n\n  useEffect(() => {\n    // console.log(\"onMount\");\n    // console.log(test.id);\n    getTestQuestions(test.id); // console.log(testQuestions);\n\n    const aceLanguage = aceLanguages.find(language => language.id == test.id_limbaj_programare);\n\n    if (aceLanguage) {\n      setLanguage(aceLanguage.name);\n    }\n\n    const defaultCode = DefaultCode.find(item => item.id == test.id_limbaj_programare);\n\n    if (defaultCode) {\n      // setCodeEditorText([defaultCode.code, defaultCode.code]);\n      setCodeEditorText([\"ceva\", \"altceva\"]);\n    }\n  }, []); //When judgeResponse change\n\n  useEffect(() => {\n    console.log(\"judge response changed\");\n\n    if (judgeResponse) {\n      setStdout(decode(judgeResponse.stdout));\n      setTestCaseStatus(judgeResponse.status.description);\n      setCompileError(decode(judgeResponse.compile_output));\n    }\n  }, [judgeResponse]);\n\n  function executaBtnHandler() {\n    if (!isConsoleLoading) {\n      console.log(\"buton executa apasat\");\n      const assignment = {\n        id: test.id,\n        questionId: currentQuestion.id,\n        source_cod: encode(codeEditorText),\n        language_id: test.id_limbaj_programare,\n        stdin: \"\"\n      };\n      console.log(assignment);\n      getJudgeAssessment(assignment);\n    }\n  }\n\n  const getJudgeAssessment = async test => {\n    console.log(\"getting assessment from judge...\");\n    setIsConsoleLoading(true);\n    const judgeData = {\n      source_code: test.source_cod,\n      language_id: test.language_id,\n      stdin: test.stdin\n    }; // console.log(test.source_cod);\n\n    const response = await axios({\n      method: \"post\",\n      url: `${rootURL}/questions/assess/${test.questionId}/${test.id}/${user.id}`,\n      data: judgeData\n    }).catch(err => console.log(err));\n\n    if (response) {\n      console.log(response.data);\n      setJudgeResponse(response.data);\n    }\n\n    setIsConsoleLoading(false);\n  };\n\n  function questionChanged(question) {\n    console.log(testQuestions);\n    console.log(question);\n    setCurrentQuestion(question);\n    const index = testQuestions.findIndex(question => question.id === currentQuestion.id);\n    setCurrentQuestionIndex(index); // setCurrentCodeEditorText(codeEditorText[index]);\n\n    console.log(codeEditorText[index]);\n    console.log(currentQuestionIndex);\n  }\n\n  function codeEditorTextChanged(text) {\n    console.log(text);\n    const index = testQuestions.findIndex(question => question.id === currentQuestion.id);\n    console.log(index);\n    let temp_state = [...codeEditorText];\n\n    if (codeEditorText.length > index) {\n      temp_state[index] = text;\n    } else {\n      temp_state.push(text);\n    }\n\n    setCodeEditorText(temp_state);\n    setCurrentCodeEditorText(text);\n  }\n\n  useEffect(() => {\n    console.log(codeEditorText);\n  }, [codeEditorText]);\n\n  if (isLoading) {\n    return /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 12\n    }, this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(Wrapper, {\n      children: [/*#__PURE__*/_jsxDEV(ProblemCard, {\n        children: /*#__PURE__*/_jsxDEV(QuestionSlider, {\n          questions: testQuestions,\n          callback: questionChanged\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(EditorCard, {\n        children: /*#__PURE__*/_jsxDEV(CodeEditor, {\n          language: language,\n          value: codeEditorText[currentQuestionIndex],\n          defaultCode: currentCodeEditorText,\n          callback: codeEditorTextChanged\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ExecuteBtn, {\n        primary: true,\n        onClick: executaBtnHandler,\n        children: \"Executa\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ConsoleCard, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [\" \", /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Output:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 173,\n            columnNumber: 13\n          }, this), !isConsoleLoading && stdout && /*#__PURE__*/_jsxDEV(\"p\", {\n            children: stdout\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 174,\n            columnNumber: 45\n          }, this), isConsoleLoading && /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Loading...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 175,\n            columnNumber: 34\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Test Case Status:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 178,\n            columnNumber: 13\n          }, this), !isConsoleLoading && testCaseStatus && /*#__PURE__*/_jsxDEV(\"p\", {\n            children: testCaseStatus\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 179,\n            columnNumber: 53\n          }, this), isConsoleLoading && /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Loading...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 180,\n            columnNumber: 34\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 11\n        }, this), !isConsoleLoading && compileError && /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Compile Error:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 185,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 184,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: compileError\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 187,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(SubmitBtn, {\n        secondary: true,\n        children: \"Trimite\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 147,\n    columnNumber: 5\n  }, this);\n}\n\n_s(TakeTest, \"10TJfmmk5D8Q9+YmHEVtZuwN5qg=\");\n\n_c = TakeTest;\nconst Wrapper = styled.section`\n  display: grid;\n  height: 100%;\n  width: 100%;\n  max-height: 700px;\n  grid-template-columns: repeat(2, 1fr);\n  grid-template-rows: repeat(10, 1fr);\n  grid-template-areas:\n    \"A    B\"\n    \"A    B\"\n    \"A    B\"\n    \"A    B\"\n    \"A    B\"\n    \"A    B\"\n    \"A    D\"\n    \"A    C\"\n    \"A    C\"\n    \"A    E\";\n  grid-column-gap: 2em;\n`;\n_c2 = Wrapper;\nconst ProblemCard = styled(Card)`\n  grid-area: A;\n  overflow: auto;\n  margin-left: 2em;\n`;\n_c3 = ProblemCard;\nconst EditorCard = styled(Card)`\n  grid-area: B;\n  margin-right: 2em;\n  margin-top: 3em;\n  align-items: streched\n  justify-items : streched;\n  \n`;\n_c4 = EditorCard;\nconst ConsoleCard = styled(Card)`\n  grid-area: C;\n  margin-right: 2em;\n  position: relative;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  overflow: auto;\n  flex-wrap: wrap;\n`;\n_c5 = ConsoleCard;\nconst ExecuteBtn = styled(Button)`\n  height: 50px;\n  width: 150px;\n  grid-are: D;\n  justify-self: start;\n  align-self: center;\n`;\n_c6 = ExecuteBtn;\nconst SubmitBtn = styled(Button)`\n  height: 50px;\n  width: 150px;\n  grid-are: E;\n  justify-self: end;\n  align-self: center;\n  margin-right: 2em;\n`;\n_c7 = SubmitBtn;\nexport default TakeTest;\n\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7;\n\n$RefreshReg$(_c, \"TakeTest\");\n$RefreshReg$(_c2, \"Wrapper\");\n$RefreshReg$(_c3, \"ProblemCard\");\n$RefreshReg$(_c4, \"EditorCard\");\n$RefreshReg$(_c5, \"ConsoleCard\");\n$RefreshReg$(_c6, \"ExecuteBtn\");\n$RefreshReg$(_c7, \"SubmitBtn\");","map":{"version":3,"sources":["C:/Users/Joseph/Desktop/BcThesis/licenta_aplicatie/code-puls/client/src/pages/takeTest.js"],"names":["Card","Button","CodeEditor","Loader","QuestionSlider","styled","React","useEffect","useState","useContext","AuthContext","AppContext","DefaultCode","axios","rootURL","TakeTest","test","setShowNavbar","setShowHeader","auth","authState","user","userInfo","testQuestions","getTestQuestions","isLoading","aceLanguages","encode","decode","language","setLanguage","stdout","setStdout","compileError","setCompileError","testCaseStatus","setTestCaseStatus","judgeResponse","setJudgeResponse","isConsoleLoading","setIsConsoleLoading","currentQuestionIndex","setCurrentQuestionIndex","currentQuestion","setCurrentQuestion","codeEditorText","setCodeEditorText","currentCodeEditorText","setCurrentCodeEditorText","id","aceLanguage","find","id_limbaj_programare","name","defaultCode","item","console","log","status","description","compile_output","executaBtnHandler","assignment","questionId","source_cod","language_id","stdin","getJudgeAssessment","judgeData","source_code","response","method","url","data","catch","err","questionChanged","question","index","findIndex","codeEditorTextChanged","text","temp_state","length","push","Wrapper","section","ProblemCard","EditorCard","ConsoleCard","ExecuteBtn","SubmitBtn"],"mappings":"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","sourcesContent":["import { Card, Button } from \"../components/defaultComponents\";\r\nimport { CodeEditor, Loader, QuestionSlider } from \"../components\";\r\nimport styled from \"styled-components\";\r\nimport React, { useEffect, useState, useContext } from \"react\";\r\nimport { AuthContext } from \"../context/AuthContext\";\r\nimport { AppContext } from \"../context/context\";\r\nimport DefaultCode from \"../components/defaultCodeData\";\r\nimport axios from \"axios\";\r\nconst rootURL = \"http://localhost:5000/api\";\r\n\r\nfunction TakeTest({ test }) {\r\n  const { setShowNavbar, setShowHeader } = useContext(AppContext);\r\n  setShowNavbar(false);\r\n  setShowHeader(true);\r\n\r\n  //get current User\r\n  const auth = useContext(AuthContext);\r\n  const { authState } = auth;\r\n  const user = authState.userInfo;\r\n\r\n  const {\r\n    testQuestions,\r\n    getTestQuestions,\r\n    isLoading,\r\n    aceLanguages,\r\n    encode,\r\n    decode,\r\n  } = React.useContext(AppContext);\r\n\r\n  const [language, setLanguage] = useState(\"javascript\");\r\n  const [stdout, setStdout] = useState(\" \");\r\n  const [compileError, setCompileError] = useState();\r\n  const [testCaseStatus, setTestCaseStatus] = useState(\" \");\r\n  const [judgeResponse, setJudgeResponse] = useState();\r\n  const [isConsoleLoading, setIsConsoleLoading] = useState(false);\r\n  const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);\r\n  const [currentQuestion, setCurrentQuestion] = useState(testQuestions[0]);\r\n  const [codeEditorText, setCodeEditorText] = useState([]);\r\n  const [currentCodeEditorText, setCurrentCodeEditorText] = useState();\r\n  //onMount\r\n  useEffect(() => {\r\n    // console.log(\"onMount\");\r\n    // console.log(test.id);\r\n    getTestQuestions(test.id);\r\n    // console.log(testQuestions);\r\n    const aceLanguage = aceLanguages.find(\r\n      (language) => language.id == test.id_limbaj_programare\r\n    );\r\n    if (aceLanguage) {\r\n      setLanguage(aceLanguage.name);\r\n    }\r\n    const defaultCode = DefaultCode.find(\r\n      (item) => item.id == test.id_limbaj_programare\r\n    );\r\n    if (defaultCode) {\r\n      // setCodeEditorText([defaultCode.code, defaultCode.code]);\r\n      setCodeEditorText([\"ceva\", \"altceva\"]);\r\n    }\r\n  }, []);\r\n\r\n  //When judgeResponse change\r\n  useEffect(() => {\r\n    console.log(\"judge response changed\");\r\n    if (judgeResponse) {\r\n      setStdout(decode(judgeResponse.stdout));\r\n      setTestCaseStatus(judgeResponse.status.description);\r\n      setCompileError(decode(judgeResponse.compile_output));\r\n    }\r\n  }, [judgeResponse]);\r\n\r\n  function executaBtnHandler() {\r\n    if (!isConsoleLoading) {\r\n      console.log(\"buton executa apasat\");\r\n      const assignment = {\r\n        id: test.id,\r\n        questionId: currentQuestion.id,\r\n        source_cod: encode(codeEditorText),\r\n        language_id: test.id_limbaj_programare,\r\n        stdin: \"\",\r\n      };\r\n      console.log(assignment);\r\n      getJudgeAssessment(assignment);\r\n    }\r\n  }\r\n\r\n  const getJudgeAssessment = async (test) => {\r\n    console.log(\"getting assessment from judge...\");\r\n    setIsConsoleLoading(true);\r\n    const judgeData = {\r\n      source_code: test.source_cod,\r\n      language_id: test.language_id,\r\n      stdin: test.stdin,\r\n    };\r\n    // console.log(test.source_cod);\r\n    const response = await axios({\r\n      method: \"post\",\r\n      url: `${rootURL}/questions/assess/${test.questionId}/${test.id}/${user.id}`,\r\n      data: judgeData,\r\n    }).catch((err) => console.log(err));\r\n\r\n    if (response) {\r\n      console.log(response.data);\r\n      setJudgeResponse(response.data);\r\n    }\r\n    setIsConsoleLoading(false);\r\n  };\r\n\r\n  function questionChanged(question) {\r\n    console.log(testQuestions);\r\n    console.log(question);\r\n    setCurrentQuestion(question);\r\n    const index = testQuestions.findIndex(\r\n      (question) => question.id === currentQuestion.id\r\n    );\r\n    setCurrentQuestionIndex(index);\r\n    // setCurrentCodeEditorText(codeEditorText[index]);\r\n    console.log(codeEditorText[index]);\r\n    console.log(currentQuestionIndex);\r\n  }\r\n\r\n  function codeEditorTextChanged(text) {\r\n    console.log(text);\r\n    const index = testQuestions.findIndex(\r\n      (question) => question.id === currentQuestion.id\r\n    );\r\n    console.log(index);\r\n    let temp_state = [...codeEditorText];\r\n\r\n    if (codeEditorText.length > index) {\r\n      temp_state[index] = text;\r\n    } else {\r\n      temp_state.push(text);\r\n    }\r\n    setCodeEditorText(temp_state);\r\n    setCurrentCodeEditorText(text);\r\n  }\r\n\r\n  useEffect(() => {\r\n    console.log(codeEditorText);\r\n  }, [codeEditorText]);\r\n\r\n  if (isLoading) {\r\n    return <Loader></Loader>;\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <Wrapper>\r\n        <ProblemCard>\r\n          <QuestionSlider\r\n            questions={testQuestions}\r\n            callback={questionChanged}\r\n          ></QuestionSlider>\r\n          {/* {testQuestions.map((question) => (\r\n            <h3>{question.descriere}</h3>\r\n          ))}\r\n          <h3>{testQuestions[0].descriere}</h3> */}\r\n        </ProblemCard>\r\n        <EditorCard>\r\n          <CodeEditor\r\n            language={language}\r\n            value={codeEditorText[currentQuestionIndex]}\r\n            defaultCode={currentCodeEditorText}\r\n            callback={codeEditorTextChanged}\r\n          ></CodeEditor>\r\n        </EditorCard>\r\n        <ExecuteBtn primary onClick={executaBtnHandler}>\r\n          Executa\r\n        </ExecuteBtn>\r\n        <ConsoleCard>\r\n          <div>\r\n            {\" \"}\r\n            <p>Output:</p>\r\n            {!isConsoleLoading && stdout && <p>{stdout}</p>}\r\n            {isConsoleLoading && <p>Loading...</p>}\r\n          </div>\r\n          <div>\r\n            <p>Test Case Status:</p>\r\n            {!isConsoleLoading && testCaseStatus && <p>{testCaseStatus}</p>}\r\n            {isConsoleLoading && <p>Loading...</p>}\r\n          </div>\r\n          {!isConsoleLoading && compileError && (\r\n            <div>\r\n              <div>\r\n                <p>Compile Error:</p>\r\n              </div>\r\n              <p>{compileError}</p>\r\n            </div>\r\n          )}\r\n        </ConsoleCard>\r\n        <SubmitBtn secondary>Trimite</SubmitBtn>\r\n      </Wrapper>\r\n    </div>\r\n  );\r\n}\r\n\r\nconst Wrapper = styled.section`\r\n  display: grid;\r\n  height: 100%;\r\n  width: 100%;\r\n  max-height: 700px;\r\n  grid-template-columns: repeat(2, 1fr);\r\n  grid-template-rows: repeat(10, 1fr);\r\n  grid-template-areas:\r\n    \"A    B\"\r\n    \"A    B\"\r\n    \"A    B\"\r\n    \"A    B\"\r\n    \"A    B\"\r\n    \"A    B\"\r\n    \"A    D\"\r\n    \"A    C\"\r\n    \"A    C\"\r\n    \"A    E\";\r\n  grid-column-gap: 2em;\r\n`;\r\nconst ProblemCard = styled(Card)`\r\n  grid-area: A;\r\n  overflow: auto;\r\n  margin-left: 2em;\r\n`;\r\nconst EditorCard = styled(Card)`\r\n  grid-area: B;\r\n  margin-right: 2em;\r\n  margin-top: 3em;\r\n  align-items: streched\r\n  justify-items : streched;\r\n  \r\n`;\r\nconst ConsoleCard = styled(Card)`\r\n  grid-area: C;\r\n  margin-right: 2em;\r\n  position: relative;\r\n  display: flex;\r\n  flex-direction: row;\r\n  justify-content: space-between;\r\n  overflow: auto;\r\n  flex-wrap: wrap;\r\n`;\r\nconst ExecuteBtn = styled(Button)`\r\n  height: 50px;\r\n  width: 150px;\r\n  grid-are: D;\r\n  justify-self: start;\r\n  align-self: center;\r\n`;\r\nconst SubmitBtn = styled(Button)`\r\n  height: 50px;\r\n  width: 150px;\r\n  grid-are: E;\r\n  justify-self: end;\r\n  align-self: center;\r\n  margin-right: 2em;\r\n`;\r\n\r\nexport default TakeTest;\r\n"]},"metadata":{},"sourceType":"module"}